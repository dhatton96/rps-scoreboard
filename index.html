<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>RPS Scoreboard</title>
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="icon" type="image/png" href="apple-touch-icon.png">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #001a33;
    color: #fff;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
    -webkit-tap-highlight-color: transparent;
  }

  /* === TOP BAR === */
  .top-bar {
    background: linear-gradient(180deg, #002244 0%, #001a33 100%);
    border-bottom: 3px solid #c8102e;
    padding: 8px 16px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #8899aa;
  }
  .top-bar .live-dot {
    width: 8px; height: 8px;
    background: #c8102e;
    border-radius: 50%;
    animation: pulse-dot 1.5s ease-in-out infinite;
  }
  @keyframes pulse-dot {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  /* === SCOREBOARD === */
  .scoreboard {
    padding: 24px 16px 16px;
  }
  .matchday {
    text-align: center;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 3px;
    color: #5a7a99;
    margin-bottom: 16px;
  }

  .score-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0;
  }

  .player {
    flex: 1;
    text-align: center;
  }
  .player-name {
    font-size: 22px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 4px;
  }
  .player-label {
    font-size: 10px;
    color: #5a7a99;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 12px;
  }

  .score-middle {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 0 8px;
  }
  .score-num {
    font-size: 72px;
    font-weight: 900;
    line-height: 1;
    font-variant-numeric: tabular-nums;
    text-shadow: 0 0 30px rgba(200, 16, 46, 0.3);
    min-width: 60px;
    text-align: center;
  }
  .score-divider {
    font-size: 40px;
    color: #334455;
    font-weight: 300;
  }

  /* === PLAYER BUTTONS === */
  .player-btns {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
  }
  .score-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.05);
    color: #fff;
    font-weight: 300;
    cursor: pointer;
    transition: all 0.2s;
    -webkit-user-select: none;
    user-select: none;
  }
  .score-btn.btn-plus {
    width: 56px;
    height: 56px;
    font-size: 28px;
  }
  .score-btn.btn-minus {
    width: 36px;
    height: 36px;
    font-size: 20px;
    border-color: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.4);
  }
  .score-btn.btn-plus:active {
    transform: scale(0.9);
    background: #c8102e;
    border-color: #c8102e;
  }
  .score-btn.btn-minus:active {
    transform: scale(0.9);
    background: #334455;
    border-color: #556677;
    color: #fff;
  }

  /* === BETTING MARKETS === */
  .markets-section {
    padding: 24px 16px;
  }
  .section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
  }
  .section-title {
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #ffd700;
  }
  .section-badge {
    font-size: 9px;
    background: #c8102e;
    color: #fff;
    padding: 2px 8px;
    border-radius: 2px;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 700;
  }

  .market-card {
    background: #0d0d0d;
    border-radius: 6px;
    padding: 14px 16px;
    margin-bottom: 8px;
    border-left: 3px solid #ffd700;
  }
  .market-name {
    font-size: 13px;
    color: #ccc;
    margin-bottom: 8px;
  }
  .market-options {
    display: flex;
    gap: 8px;
  }
  .market-option {
    flex: 1;
    background: #1a1a1a;
    border-radius: 4px;
    padding: 10px 8px;
    text-align: center;
    border: 1px solid #333;
  }
  .market-option-label {
    font-size: 10px;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
  }
  .market-option-odds {
    font-size: 16px;
    font-weight: 800;
    color: #ffd700;
  }

  /* === MATCH REPORT === */
  .report-section {
    padding: 0 16px 24px;
  }
  .report-card {
    background: linear-gradient(135deg, #0a0a0a 0%, #111 100%);
    border-radius: 6px;
    padding: 16px;
    border-left: 3px solid #c8102e;
  }
  .report-headline {
    font-size: 18px;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 1px;
    line-height: 1.3;
    color: #fff;
    margin-bottom: 6px;
  }
  .report-sub {
    font-size: 11px;
    color: #5a7a99;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .report-placeholder {
    font-size: 13px;
    color: #334455;
    font-style: italic;
  }

  /* === STUDIO ANALYSIS === */
  .studio-section {
    padding: 0 16px 24px;
  }
  .speech-bubble {
    background: #0d1a2a;
    border-radius: 12px;
    border-top-left-radius: 4px;
    padding: 14px 16px;
    position: relative;
    margin-top: 8px;
    border: 1px solid #1a2a3a;
  }
  .speech-bubble::before {
    content: '';
    position: absolute;
    top: -8px;
    left: 16px;
    width: 0; height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid #1a2a3a;
  }
  .speech-bubble::after {
    content: '';
    position: absolute;
    top: -7px;
    left: 17px;
    width: 0; height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 7px solid #0d1a2a;
  }
  .pundit-name {
    font-size: 11px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #ffd700;
    margin-bottom: 6px;
  }
  .pundit-quote {
    font-size: 14px;
    color: #ccd6e0;
    line-height: 1.5;
    font-style: italic;
  }
  .studio-placeholder {
    font-size: 13px;
    color: #334455;
    font-style: italic;
    margin-top: 8px;
  }

  /* === GOAL OVERLAY === */
  .goal-overlay {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    pointer-events: none;
    opacity: 0;
  }
  .goal-overlay.active {
    animation: goal-flash 1.8s ease-out forwards;
  }
  .goal-text {
    font-size: 80px;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 8px;
    text-shadow:
      0 0 20px rgba(255,215,0,0.8),
      0 0 60px rgba(200,16,46,0.6),
      0 4px 0 #8b0000;
    color: #fff;
    transform: scale(0);
  }
  .goal-overlay.active .goal-text {
    animation: goal-text-in 1.8s ease-out forwards;
  }
  @keyframes goal-flash {
    0% { opacity: 1; background: rgba(200,16,46,0.4); }
    30% { background: rgba(200,16,46,0); }
    100% { opacity: 0; }
  }
  @keyframes goal-text-in {
    0% { transform: scale(0) rotate(-10deg); opacity: 0; }
    15% { transform: scale(1.3) rotate(3deg); opacity: 1; }
    30% { transform: scale(1) rotate(0); }
    70% { transform: scale(1); opacity: 1; }
    100% { transform: scale(1.5); opacity: 0; }
  }

  /* === FIREWORKS CANVAS === */
  #fireworks-canvas {
    position: fixed;
    inset: 0;
    z-index: 999;
    pointer-events: none;
  }

  /* === WAHEY OVERLAY === */
  .wahey-overlay {
    position: fixed;
    bottom: 20%;
    left: 50%;
    transform: translateX(-50%) scale(0);
    z-index: 1001;
    pointer-events: none;
    font-size: 36px;
    font-weight: 900;
    color: #ffd700;
    text-shadow: 0 0 20px rgba(255,215,0,0.5);
    opacity: 0;
    letter-spacing: 4px;
  }
  .wahey-overlay.active {
    animation: wahey-in 1.6s ease-out forwards;
  }
  @keyframes wahey-in {
    0% { transform: translateX(-50%) scale(0) rotate(-5deg); opacity: 0; }
    20% { transform: translateX(-50%) scale(1.2) rotate(3deg); opacity: 1; }
    40% { transform: translateX(-50%) scale(1) rotate(0); }
    70% { opacity: 1; }
    100% { transform: translateX(-50%) scale(1) translateY(-40px); opacity: 0; }
  }

  /* === RESET === */
  .reset-area {
    text-align: center;
    padding: 40px 16px 24px;
  }
  .reset-btn {
    background: none;
    border: 1px solid #1a2a3a;
    color: #334455;
    font-size: 10px;
    padding: 6px 16px;
    border-radius: 3px;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.2s;
  }
  .reset-btn:active {
    color: #c8102e;
    border-color: #c8102e;
  }
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="top-bar">
  <div class="live-dot"></div>
  <span>Live &middot; Rock Paper Scissors</span>
</div>

<!-- SCOREBOARD -->
<div class="scoreboard">
  <div class="matchday">Season 2025/26</div>
  <div class="score-container">
    <div class="player">
      <div class="player-name">Desi</div>
      <div class="player-label">Home</div>
      <div class="player-btns">
        <button class="score-btn btn-minus" onclick="removePoint('desi')">&minus;</button>
        <button class="score-btn btn-plus" onclick="addPoint('desi')">+</button>
      </div>
    </div>
    <div class="score-middle">
      <div class="score-num" id="score-desi">0</div>
      <div class="score-divider">&ndash;</div>
      <div class="score-num" id="score-danny">0</div>
    </div>
    <div class="player">
      <div class="player-name">Danny</div>
      <div class="player-label">Away</div>
      <div class="player-btns">
        <button class="score-btn btn-plus" onclick="addPoint('danny')">+</button>
        <button class="score-btn btn-minus" onclick="removePoint('danny')">&minus;</button>
      </div>
    </div>
  </div>
</div>

<!-- BETTING MARKETS -->
<div class="markets-section">
  <div class="section-header">
    <span class="section-title">Live Markets</span>
    <span class="section-badge">In-Play</span>
  </div>

  <div class="market-card" id="market-winner">
    <div class="market-name">Overall Winner</div>
    <div class="market-options">
      <div class="market-option">
        <div class="market-option-label">Desi</div>
        <div class="market-option-odds" id="odds-desi">EVS</div>
      </div>
      <div class="market-option">
        <div class="market-option-label">Draw</div>
        <div class="market-option-odds" id="odds-draw">3/1</div>
      </div>
      <div class="market-option">
        <div class="market-option-label">Danny</div>
        <div class="market-option-odds" id="odds-danny">EVS</div>
      </div>
    </div>
  </div>

  <div class="market-card">
    <div class="market-name">Danny to win next 3</div>
    <div class="market-options">
      <div class="market-option">
        <div class="market-option-label">Yes</div>
        <div class="market-option-odds">5/1</div>
      </div>
      <div class="market-option">
        <div class="market-option-label">No</div>
        <div class="market-option-odds">1/8</div>
      </div>
    </div>
  </div>

  <div class="market-card">
    <div class="market-name">Desi to play Rock next</div>
    <div class="market-options">
      <div class="market-option">
        <div class="market-option-label">Yes</div>
        <div class="market-option-odds">EVS</div>
      </div>
      <div class="market-option">
        <div class="market-option-label">No</div>
        <div class="market-option-odds">4/5</div>
      </div>
    </div>
  </div>
</div>

<!-- MATCH REPORT -->
<div class="report-section">
  <div class="section-header">
    <span class="section-title">Match Report</span>
    <span class="section-badge">Sky Sports</span>
  </div>
  <div class="report-card" id="report-card">
    <div class="report-headline" id="report-headline"></div>
    <div class="report-sub" id="report-sub"></div>
    <div class="report-placeholder" id="report-placeholder">Awaiting first point...</div>
  </div>
</div>

<!-- STUDIO ANALYSIS -->
<div class="studio-section">
  <div class="section-header">
    <span class="section-title">Studio Analysis</span>
    <span class="section-badge">MNF</span>
  </div>
  <div id="studio-content">
    <div class="studio-placeholder">The pundits are warming up...</div>
  </div>
</div>

<!-- RESET -->
<div class="reset-area">
  <button class="reset-btn" onclick="resetScores()">Reset Season</button>
</div>

<!-- OVERLAYS -->
<div class="goal-overlay" id="goal-overlay">
  <div class="goal-text" id="goal-text">GOAL!</div>
</div>
<div class="wahey-overlay" id="wahey-overlay">WAHEY!</div>
<canvas id="fireworks-canvas"></canvas>

<script>
  // --- State ---
  let scores = JSON.parse(localStorage.getItem('rps-scores')) || { desi: 0, danny: 0 };

  const elDesi = document.getElementById('score-desi');
  const elDanny = document.getElementById('score-danny');
  const goalOverlay = document.getElementById('goal-overlay');
  const goalText = document.getElementById('goal-text');
  const waheyOverlay = document.getElementById('wahey-overlay');
  const canvas = document.getElementById('fireworks-canvas');
  const ctx = canvas.getContext('2d');

  function render() {
    elDesi.textContent = scores.desi;
    elDanny.textContent = scores.danny;
    updateOdds();
    localStorage.setItem('rps-scores', JSON.stringify(scores));
  }

  function addPoint(player) {
    scores[player]++;
    render();
    generateHeadline(player);
    generatePunditQuote(player);
    triggerCelebration();
  }

  function removePoint(player) {
    if (scores[player] > 0) {
      scores[player]--;
      render();
    }
  }

  function resetScores() {
    if (confirm('Reset the season? This clears all scores.')) {
      scores = { desi: 0, danny: 0 };
      render();
      document.getElementById('report-headline').textContent = '';
      document.getElementById('report-sub').textContent = '';
      document.getElementById('report-placeholder').textContent = 'Awaiting first point...';
      document.getElementById('studio-content').innerHTML = '<div class="studio-placeholder">The pundits are warming up...</div>';
    }
  }

  // --- Dynamic Odds ---
  function updateOdds() {
    const d = scores.desi, n = scores.danny;
    const diff = d - n;

    const oddsDesEl = document.getElementById('odds-desi');
    const oddsDanEl = document.getElementById('odds-danny');
    const oddsDrawEl = document.getElementById('odds-draw');

    if (diff === 0) {
      oddsDesEl.textContent = 'EVS';
      oddsDanEl.textContent = 'EVS';
      oddsDrawEl.textContent = '3/1';
    } else if (diff > 0) {
      const lead = Math.min(diff, 8);
      const winnerOdds = ['1/2','2/5','1/3','1/4','1/5','1/6','1/8','1/10'];
      const loserOdds = ['6/4','2/1','3/1','4/1','6/1','8/1','12/1','16/1'];
      const drawOdds = ['7/2','4/1','5/1','6/1','8/1','10/1','14/1','20/1'];
      oddsDesEl.textContent = winnerOdds[lead - 1];
      oddsDanEl.textContent = loserOdds[lead - 1];
      oddsDrawEl.textContent = drawOdds[lead - 1];
    } else {
      const lead = Math.min(-diff, 8);
      const winnerOdds = ['1/2','2/5','1/3','1/4','1/5','1/6','1/8','1/10'];
      const loserOdds = ['6/4','2/1','3/1','4/1','6/1','8/1','12/1','16/1'];
      const drawOdds = ['7/2','4/1','5/1','6/1','8/1','10/1','14/1','20/1'];
      oddsDanEl.textContent = winnerOdds[lead - 1];
      oddsDesEl.textContent = loserOdds[lead - 1];
      oddsDrawEl.textContent = drawOdds[lead - 1];
    }
  }

  // --- Match Report Headlines ---
  function generateHeadline(scorer) {
    const other = scorer === 'desi' ? 'danny' : 'desi';
    const sName = scorer === 'desi' ? 'DESI' : 'DANNY';
    const oName = other === 'desi' ? 'DESI' : 'DANNY';
    const diff = scores[scorer] - scores[other];
    const total = scores.desi + scores.danny;

    let headlines;

    if (diff >= 3) {
      headlines = [
        `${sName} PULLS CLEAR IN DOMINANT DISPLAY`,
        `RUTHLESS ${sName} LEAVES ${oName} SHELL-SHOCKED`,
        `${oName} IN CRISIS AS ${sName} RUNS RIOT`,
        `CLINICAL ${sName} OPENS UP COMMANDING LEAD`,
        `${sName} MASTERCLASS LEAVES ${oName} IN TATTERS`,
      ];
    } else if (diff === 1) {
      headlines = [
        `${sName} EDGES AHEAD IN TIGHT CONTEST`,
        `${sName} STUNS ${oName} IN LATE DRAMA`,
        `HEARTBREAK FOR ${oName} AS ${sName} NICKS IT`,
        `${sName} TAKES THE LEAD IN PULSATING CLASH`,
        `DRAMA! ${sName} SNATCHES THE ADVANTAGE`,
      ];
    } else if (diff === 2) {
      headlines = [
        `${sName} STARTING TO PULL AWAY`,
        `${oName} UNDER PRESSURE AS ${sName} EXTENDS LEAD`,
        `CLINICAL ${sName} PULLS CLEAR`,
        `${sName} DOUBLES THE ADVANTAGE OVER ${oName}`,
        `${oName} ROCKED AS ${sName} TURNS THE SCREW`,
      ];
    } else if (diff === 0) {
      headlines = [
        `${sName} LEVELS IT! WE'RE ALL SQUARE`,
        `INCREDIBLE SCENES! ${sName} BRINGS IT LEVEL`,
        `${sName} DRAGS IT BACK! GAME ON`,
        `DRAMA! ${sName} EQUALISES IN SENSATIONAL STYLE`,
        `ALL SQUARE! THE MOMENTUM HAS SHIFTED`,
      ];
    } else {
      headlines = [
        `${sName} PULLS ONE BACK! IS A COMEBACK ON?`,
        `CONSOLATION FOR ${sName} BUT ${oName} STILL LEADS`,
        `${sName} SHOWS FIGHT WITH A REPLY`,
        `${sName} REFUSES TO LIE DOWN`,
      ];
    }

    const headline = headlines[Math.floor(Math.random() * headlines.length)];
    const sub = `Round ${total} \u00B7 ${scores.desi} - ${scores.danny}`;

    document.getElementById('report-placeholder').textContent = '';
    document.getElementById('report-headline').textContent = headline;
    document.getElementById('report-sub').textContent = sub;
  }

  // --- Pundit Quotes ---
  const garyQuotes = {
    scorer: [
      "Ooooh! {SCORER}'s absolutely done {OTHER} there, Jamie! High press, clinical finish!",
      "That is BRILLIANT from {SCORER}. You cannot defend that. World class.",
      "I'm sorry but {SCORER} is just on another level tonight. {OTHER} doesn't know what day it is.",
      "Look at the composure! {SCORER}'s looked at {OTHER}, sized up the situation, and gone BANG.",
      "That's the sign of a champion, Jamie. When the pressure's on, {SCORER} delivers.",
      "{SCORER}'s reading {OTHER} like a book! Absolutely magnificent.",
      "You talk about the big moments in big games... THAT is why {SCORER} turns up.",
    ],
    conceder: [
      "I'm looking at {OTHER}'s defense there, it's non-existent. Shocking.",
      "{OTHER} has got to do better there. You can't switch off at this level.",
      "That is criminal from {OTHER}. Absolutely criminal. Where's the awareness?",
      "{OTHER}'s been found out. I said it before this round and I'll say it again.",
      "Look at {OTHER}'s body language. Head's gone. Absolutely gone.",
    ],
  };

  const jamieQuotes = {
    scorer: [
      "Look at the footwork, Gary! {SCORER}'s played that perfectly!",
      "{SCORER}'s on FIRE! You could see that one coming a mile off!",
      "That's a massive momentum shift. {SCORER}'s got the bit between the teeth now.",
      "What a response from {SCORER}! The mentality on show here is frightening.",
      "{SCORER} is taking the game to {OTHER} and I LOVE it!",
      "SCENES! {SCORER} with nerves of absolute steel! That's what you need!",
      "Gary, when {SCORER}'s in this mood, you simply cannot stop what's coming.",
    ],
    conceder: [
      "{OTHER}'s bottled it for me. That's a massive momentum shift.",
      "I feel for {OTHER} there but you've got to show more. Got to show character.",
      "{OTHER} just didn't turn up for that one. Really disappointing.",
      "You can see {OTHER}'s overthinking it. Sometimes you just have to back yourself.",
      "The nerves have got to {OTHER}. You could see it from the studio.",
    ],
  };

  function generatePunditQuote(scorer) {
    const other = scorer === 'desi' ? 'danny' : 'desi';
    const sName = scorer === 'desi' ? 'Desi' : 'Danny';
    const oName = other === 'desi' ? 'Desi' : 'Danny';

    // Pick Gary or Jamie randomly
    const isGary = Math.random() > 0.5;
    const punditName = isGary ? 'Gary Neville' : 'Jamie Carragher';
    const bank = isGary ? garyQuotes : jamieQuotes;

    // 70% scorer-focused, 30% conceder-focused
    const pool = Math.random() < 0.7 ? bank.scorer : bank.conceder;
    let quote = pool[Math.floor(Math.random() * pool.length)];
    quote = quote.replace(/\{SCORER\}/g, sName).replace(/\{OTHER\}/g, oName);

    const studioEl = document.getElementById('studio-content');
    studioEl.innerHTML = `
      <div class="speech-bubble">
        <div class="pundit-name">${punditName}</div>
        <div class="pundit-quote">"${quote}"</div>
      </div>
    `;
  }

  // --- Celebration ---
  const celebTexts = ['GOAL!', 'BOOM!', 'GET IN!', 'SCENES!'];

  function triggerCelebration() {
    // Goal text
    goalText.textContent = celebTexts[Math.floor(Math.random() * celebTexts.length)];
    goalOverlay.classList.remove('active');
    waheyOverlay.classList.remove('active');
    void goalOverlay.offsetWidth; // reflow
    goalOverlay.classList.add('active');

    // Wahey
    setTimeout(() => {
      waheyOverlay.classList.remove('active');
      void waheyOverlay.offsetWidth;
      waheyOverlay.classList.add('active');
    }, 300);

    // Fireworks
    launchFireworks();

    // Vibrate if available
    if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
  }

  // --- Fireworks ---
  let particles = [];
  let animating = false;

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);

  function launchFireworks() {
    const colors = ['#c8102e','#ffd700','#ff6b35','#00d4ff','#fff','#ff3366'];
    // Launch 3 bursts
    for (let b = 0; b < 3; b++) {
      setTimeout(() => {
        const cx = canvas.width * (0.2 + Math.random() * 0.6);
        const cy = canvas.height * (0.15 + Math.random() * 0.35);
        const color = colors[Math.floor(Math.random() * colors.length)];
        for (let i = 0; i < 50; i++) {
          const angle = (Math.PI * 2 / 50) * i + (Math.random() - 0.5) * 0.3;
          const speed = 2 + Math.random() * 4;
          particles.push({
            x: cx, y: cy,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: 1,
            decay: 0.012 + Math.random() * 0.015,
            color: color,
            size: 2 + Math.random() * 2
          });
        }
      }, b * 250);
    }
    if (!animating) {
      animating = true;
      animateFireworks();
    }
  }

  function animateFireworks() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = particles.length - 1; i >= 0; i--) {
      const p = particles[i];
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.04; // gravity
      p.life -= p.decay;
      if (p.life <= 0) {
        particles.splice(i, 1);
        continue;
      }
      ctx.globalAlpha = p.life;
      ctx.fillStyle = p.color;
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
    if (particles.length > 0) {
      requestAnimationFrame(animateFireworks);
    } else {
      animating = false;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
  }

  // --- Init ---
  render();
</script>
</body>
</html>
